<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>æ°¸æ’çš„çˆ± - æˆ‘ä»¬çš„æ•…äº‹</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Dancing+Script:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            --accent-gradient: linear-gradient(45deg, #e6b0ff, #c8a4ff, #a5d8ff);
            --pink-accent: #ff9ecb;
            --purple-accent: #c8a4ff;
            --blue-accent: #a5d8ff;
            --light-purple: #e6b0ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            color: #fff;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            cursor: default;
        }

        .container {
            width: 100%;
            max-width: 900px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            margin: 0 auto;
            padding: 15px;
        }

        /* åˆå§‹é—®é¢˜é¡µé¢ */
        .question-screen {
            text-align: center;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 10;
            border: 1px solid rgba(255, 255, 255, 0.15);
            animation: fadeIn 1s ease-out;
            width: 100%;
            max-width: 500px;
            position: relative;
            overflow: hidden;
            margin: 0;
        }

        .question-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-gradient);
            border-radius: 8px 8px 0 0;
        }

        /* é¡¶éƒ¨è£…é¥° */
        .top-decoration {
            width: 100%;
            height: 30px;
            position: relative;
            margin-bottom: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .heart-line {
            width: 60%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--light-purple), var(--purple-accent), var(--light-purple), transparent);
            position: relative;
        }

        .heart-line:before,
        .heart-line:after {
            content: 'â¤';
            position: absolute;
            top: -8px;
            color: var(--pink-accent);
            font-size: 18px;
            text-shadow: 0 0 8px rgba(255, 158, 203, 0.7);
            animation: pulse 1.5s infinite alternate;
        }

        .heart-line:before {
            left: 0;
        }

        .heart-line:after {
            right: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.2); }
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 1.2rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
            font-weight: 700;
            letter-spacing: 0.5px;
            line-height: 1.3;
            font-family: 'Playfair Display', serif;
            padding: 0 8px;
            opacity: 0;
            animation: fadeInUp 1s 0.5s forwards;
        }

        .options {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .option-btn {
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            background: var(--accent-gradient);
            color: #1a1a2e;
            box-shadow: 0 5px 15px rgba(165, 216, 255, 0.4);
            transition: all 0.3s ease;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            min-width: 120px;
            opacity: 0;
            transform: translateY(20px);
        }

        .option-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: 0.4s;
        }

        .option-btn:hover:before {
            left: 100%;
        }

        .option-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(165, 216, 255, 0.6);
        }

        /* æ¸©æŸ”æç¤ºé¡µé¢ */
        .gentle-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 26, 46, 0.97);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }

        .gentle-screen.active {
            opacity: 1;
            pointer-events: all;
        }

        .flowers-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .flower {
            position: absolute;
            font-size: 30px;
            opacity: 0;
            animation: fallDown 8s linear forwards;
            color: var(--light-purple);
            text-shadow: 0 0 8px rgba(230, 176, 255, 0.6);
        }

        @keyframes fallDown {
            0% {
                transform: translateY(-80px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .gentle-message {
            margin-top: 1.5rem;
            font-size: 1.8rem;
            color: var(--light-purple);
            text-align: center;
            font-weight: bold;
            z-index: 52;
            opacity: 0;
            animation: fadeInMessage 0.4s 0.8s forwards;
            text-shadow: 0 0 15px rgba(230, 176, 255, 0.7);
            max-width: 80%;
            line-height: 1.3;
            font-family: 'Dancing Script', cursive;
            padding: 15px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            border: 1px solid rgba(230, 176, 255, 0.25);
        }

        @keyframes fadeInMessage {
            to { opacity: 1; }
        }

        .back-btn {
            margin-top: 1.5rem;
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.25);
            color: white;
            border-radius: 40px;
            cursor: pointer;
            font-size: 0.9rem;
            z-index: 52;
            opacity: 0;
            animation: fadeInMessage 0.4s 1.2s forwards;
            transition: all 0.25s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        }

        /* ä¹¦æœ¬æ ·å¼ */
        .book-3d {
            position: relative;
            width: 100%;
            height: 380px;
            perspective: 1800px;
            margin: 0.5rem 0;
        }

        .page-3d {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.98);
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(230, 176, 255, 0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            backface-visibility: hidden;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.645, 0.045, 0.355, 1);
            padding: 25px;
            transform-origin: left center;
            z-index: 1;
        }

        .page-3d:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0,0,0,0.08) 1px, transparent 1px);
            background-size: 100% 18px;
            z-index: 1;
            pointer-events: none;
            opacity: 0.25;
        }

        .page-3d::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            bottom: 8px;
            left: 8px;
            border: 1px solid rgba(230, 176, 255, 0.15);
            border-radius: 6px;
            pointer-events: none;
        }

        .page-3d.flipped {
            transform: rotateY(-180deg);
            z-index: 2;
        }

        .page-content {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 2;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .page-content p {
            line-height: 1.7;
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            color: rgba(255, 255, 255, 0.9);
            text-align: justify;
            text-shadow: 0 0 6px rgba(0, 0, 0, 0.25);
            font-family: 'Playfair Display', serif;
            transition: all 0.8s ease;
            opacity: 0;
            transform: translateY(15px);
            word-break: break-word;
            white-space: normal;
        }

        .page-content p.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* æŠ•å½±æ–‡å­—æ•ˆæœï¼ˆç¡®ä¿æ–‡æœ¬å¯è§ï¼‰ */
        .projected-text {
            text-shadow:
                    0 0 8px rgba(230, 176, 255, 0.7),
                    0 0 15px rgba(230, 176, 255, 0.5),
                    0 0 25px rgba(230, 176, 255, 0.3);
            color: rgba(255, 255, 255, 0.95);
            background-clip: text;
            -webkit-background-clip: text;
        }

        .flip-btn {
            position: absolute;
            bottom: 15px;
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            cursor: pointer;
            z-index: 10;
            transition: all 0.25s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .flip-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .flip-prev {
            left: 20px;
        }

        .flip-next {
            right: 20px;
        }

        /* å†…å®¹å±å¹• */
        .content-screen {
            width: 100%;
            max-width: 800px;
            height: 90vh;
            opacity: 0;
            transform: translateY(15px);
            pointer-events: none;
            position: absolute;
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            top: 0;
            transition: all 0.4s ease;
        }

        .content-screen.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
            position: relative;
        }

        /* æµªæ¼«æ‰¿è¯º */
        .promise-container {
            position: relative;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0.5rem 0;
            perspective: 800px;
        }

        .promise {
            font-size: 1.8rem;
            text-align: center;
            color: var(--light-purple);
            font-weight: bold;
            text-shadow: 0 0 15px rgba(230, 176, 255, 0.5);
            opacity: 0;
            transform: translateY(30px) rotateX(80deg);
            transition: all 1.2s cubic-bezier(0.17, 0.67, 0.83, 0.67);
            padding: 1.2rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            box-shadow: 0 0 30px rgba(230, 176, 255, 0.3);
            position: relative;
            overflow: hidden;
            line-height: 1.3;
            width: 100%;
            max-width: 700px;
            border: 1px solid rgba(230, 176, 255, 0.25);
            font-family: 'Dancing Script', cursive;
            z-index: 5;
        }

        .promise.show {
            opacity: 1;
            transform: translateY(0) rotateX(0);
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotateX(0); box-shadow: 0 0 30px rgba(230, 176, 255, 0.3); }
            50% { transform: scale(1.03) rotateX(4deg); box-shadow: 0 0 45px rgba(230, 176, 255, 0.5); }
        }

        /* ç¯ç»•çˆ±å¿ƒæ•ˆæœ */
        .circle-hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 4;
        }

        .circle-heart {
            position: absolute;
            font-size: 18px;
            color: var(--pink-accent);
            opacity: 0;
            animation: circleRotate 15s linear infinite;
            text-shadow: 0 0 8px rgba(255, 158, 203, 0.6);
        }

        @keyframes circleRotate {
            0% {
                transform: rotate(0deg) translateX(100px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: rotate(360deg) translateX(100px) rotate(-360deg);
                opacity: 0.8;
            }
        }

        .hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .heart {
            position: absolute;
            font-size: 18px;
            opacity: 0;
            animation: float 8s linear infinite;
            color: var(--pink-accent);
            text-shadow: 0 0 8px rgba(255, 158, 203, 0.6);
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.7; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        /* èƒŒæ™¯å…ƒç´  */
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            animation: floatParticle 15s infinite linear;
        }

        @keyframes floatParticle {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        /* æµªæ¼«èƒŒæ™¯å…ƒç´  */
        .romantic-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-heart {
            position: absolute;
            font-size: 20px;
            color: var(--pink-accent);
            opacity: 0;
            animation: floatingHearts 15s linear infinite;
            text-shadow: 0 0 10px rgba(255, 158, 203, 0.7);
        }

        @keyframes floatingHearts {
            0% {
                transform: translate(0, 100vh) rotate(0deg);
                opacity: 0.7;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translate(calc(100vw * var(--random-x)), -80px) rotate(360deg);
                opacity: 0;
            }
        }

        .sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #fff;
            border-radius: 50%;
            opacity: 0;
            animation: sparkle 3s infinite;
            box-shadow: 0 0 8px #fff;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        /* è½¬åœºæ•ˆæœ - å¢å¼ºç‰ˆ */
        .transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--accent-gradient);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.6s ease;
            overflow: hidden;
        }

        .transition-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .transition-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transform: scale(0.8);
            font-family: 'Dancing Script', cursive;
            transition: all 0.6s ease;
            position: relative;
            z-index: 102;
        }

        .transition-text.show {
            opacity: 1;
            transform: scale(1);
            animation: pulseText 1.2s infinite alternate;
        }

        @keyframes pulseText {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        /* æ–°å¢åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¢å¼ºçš„è½¬åœºåŠ¨ç”»å…ƒç´  */
        .transition-hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 101;
        }

        .transition-heart {
            position: absolute;
            font-size: 24px;
            color: var(--pink-accent);
            opacity: 0;
            animation: transitionHeart 2s ease-out forwards;
            text-shadow: 0 0 10px rgba(255, 158, 203, 0.7);
        }

        @keyframes transitionHeart {
            0% {
                transform: translateY(100vh) scale(0.5) rotate(0deg);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1.5) rotate(360deg);
                opacity: 0;
            }
        }

        /* æ–°å¢ï¼šç‚¹å‡»ç‰¹æ•ˆ - å·²æ”¾å¤§ */
        .click-effect {
            position: absolute;
            pointer-events: none;
            z-index: 9999;
            animation: clickAnimation 1.5s forwards;
            font-size: 40px; /* æ”¾å¤§å­—ä½“ */
        }

        @keyframes clickAnimation {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(4); /* æ”¾å¤§åŠ¨ç”» */
                opacity: 0;
            }
        }

        /* æ–°å¢ï¼šçˆ±å¿ƒçˆ†ç‚¸æ•ˆæœ */
        .heart-explosion {
            position: absolute;
            pointer-events: none;
            z-index: 999;
        }

        .heart-particle {
            position: absolute;
            font-size: 28px; /* æ”¾å¤§çˆ±å¿ƒç²’å­ */
            color: var(--pink-accent);
            opacity: 0;
            animation: heartParticle 1.5s ease-out forwards;
            text-shadow: 0 0 12px rgba(255, 158, 203, 0.8); /* å¢å¼ºå‘å…‰æ•ˆæœ */
        }

        @keyframes heartParticle {
            0% {
                transform: translate(0, 0) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(
                        calc(var(--tx) * 150px), /* å¢åŠ æ‰©æ•£è·ç¦» */
                        calc(var(--ty) * 150px)
                ) scale(2); /* æ”¾å¤§ç»“æŸå°ºå¯¸ */
                opacity: 0;
            }
        }

        /* æ–°å¢ï¼šèŠ±ç“£é£˜è½æ•ˆæœ */
        .petal {
            position: absolute;
            font-size: 32px; /* æ”¾å¤§èŠ±ç“£ */
            opacity: 0;
            pointer-events: none;
            z-index: 999;
            animation: petalFall 12s linear forwards;
        }

        @keyframes petalFall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* æ–°å¢ï¼šç²’å­æ–‡å­—æ•ˆæœ */
        .particle-text-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 999;
            pointer-events: none;
        }

        .text-particle {
            position: absolute;
            width: 8px; /* æ”¾å¤§ç²’å­ */
            height: 8px;
            border-radius: 50%;
            background: var(--pink-accent);
            opacity: 0;
            animation: textParticle 2s ease-out forwards;
        }

        @keyframes textParticle {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(
                        calc(var(--tx) * 1px),
                        calc(var(--ty) * 1px)
                );
                opacity: 0.8;
            }
        }

        /* æ¯ä¸ªå­—ç¬¦çš„è¿‡æ¸¡æ•ˆæœ */
        .typewriter p {
            border-right: 2px solid rgba(255, 255, 255, 0.8);
            margin: 0;
            padding-right: 2px;
            display: inline-block;
            white-space: normal;
        }

        .typewriter .char {
            display: inline-block;
            opacity: 0;
            transform: translateY(6px) scale(0.98);
            transition: opacity 260ms cubic-bezier(.2,.9,.2,1), transform 260ms cubic-bezier(.2,.9,.2,1);
            will-change: opacity, transform;
        }

        .typewriter .char.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .typewriter-effect {
            animation: blink 0.8s step-end infinite;
        }
        @keyframes blink {
            50% { border-color: transparent; }
        }
        /* ================================================================ */

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 900px) {
            .book-3d {
                height: 340px;
            }

            h1 {
                font-size: 1.6rem;
            }

            .promise {
                font-size: 1.6rem;
            }
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.5rem; }
            .question-screen {
                padding: 1.5rem;
            }
            .options {
                flex-direction: column;
                gap: 0.8rem;
                margin-top: 1.2rem;
            }
            .option-btn {
                width: 100%;
                padding: 0.8rem 1.2rem;
                font-size: 0.9rem;
            }

            .book-3d {
                height: 300px;
            }

            .page-content {
                padding: 1.2rem;
            }

            .page-content p {
                font-size: 1.1rem;
                line-height: 1.6;
            }

            .promise {
                font-size: 1.4rem;
                padding: 1rem;
                line-height: 1.2;
            }

            .gentle-message { font-size: 1.5rem; }

            .container {
                padding: 8px;
            }

            .content-screen {
                padding: 8px;
            }

            .transition-text {
                font-size: 2rem;
            }

            .back-btn {
                margin-top: 1.2rem;
            }

            .top-decoration, .bottom-decoration {
                height: 25px;
            }

            .flip-btn {
                width: 40px;
                height: 40px;
                bottom: 12px;
            }

            .flip-prev {
                left: 12px;
            }

            .flip-next {
                right: 12px;
            }
        }

        @media (max-width: 480px) {
            h1 { font-size: 1.3rem; }
            .promise {
                font-size: 1.2rem;
                padding: 0.8rem;
            }

            .book-3d {
                height: 280px;
            }

            .page-content {
                padding: 1rem;
            }

            .page-content p {
                font-size: 1rem;
                line-height: 1.5;
            }

            .top-decoration, .bottom-decoration {
                height: 20px;
            }

            .flip-btn {
                width: 35px;
                height: 35px;
                bottom: 10px;
            }

            .flip-prev {
                left: 8px;
            }

            .flip-next {
                right: 8px;
            }

            .gentle-message {
                font-size: 1.2rem;
                padding: 12px;
            }
        }

        /* æ–°å¢ï¼šå‡å°‘åŠ¨ç”»å¯¹æ€§èƒ½çš„å½±å“ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* æ–°å¢ï¼šç„¦ç‚¹çŠ¶æ€æ ·å¼ï¼Œæé«˜å¯è®¿é—®æ€§ */
        button:focus {
            outline: 2px solid var(--light-purple);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
<div class="floating-particles" id="floatingParticles"></div>
<div class="romantic-elements" id="romanticElements"></div>
<div class="transition-overlay" id="transitionOverlay">
    <div class="transition-hearts" id="transitionHearts"></div>
    <div class="transition-text" id="transitionText">æˆ‘å°±çŸ¥é“ä½ æ˜¯æœ€èªæ˜çš„ï¼</div>
</div>

<div class="container">
    <!-- é¡¶éƒ¨è£…é¥° -->
    <div class="top-decoration">
        <div class="heart-line"></div>
    </div>

    <!-- åˆå§‹é—®é¢˜é¡µé¢ -->
    <div class="question-screen" id="questionScreen">
        <h1>"æ—¶é—´"ä¸€å®šæ˜¯çœŸå®å­˜åœ¨çš„å—ï¼Ÿ</h1>
        <div class="options">
            <button class="option-btn" id="optionYes">å½“ç„¶å­˜åœ¨</button>
            <button class="option-btn" id="optionNo">è®©æˆ‘æƒ³æƒ³</button>
        </div>
    </div>

    <!-- æ¸©æŸ”æç¤ºé¡µé¢ -->
    <div class="gentle-screen" id="gentleScreen">
        <div class="flowers-container" id="flowersContainer"></div>
        <div class="gentle-message">è¿™éƒ½ç­”ä¸å¯¹ï¼Œä½ æ˜¯ç¬¨è›‹å—ï¼Ÿ</div>
        <button class="back-btn" id="backFromGentle">è¿”å›</button>
    </div>

    <!-- é‡æ–°è®¾è®¡çš„å†…å®¹é¡µé¢ -->
    <div class="content-screen" id="contentScreen">
        <!-- 3Dä¹¦æœ¬å®¹å™¨ -->
        <div class="book-3d" id="book3d">
            <!-- é¡µé¢å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- ç¿»é¡µæŒ‰é’® -->
        <button class="flip-btn flip-prev" id="flipPrev">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="flip-btn flip-next" id="flipNext">
            <i class="fas fa-chevron-right"></i>
        </button>

        <div class="promise-container">
            <div class="circle-hearts" id="circleHearts"></div>
            <div class="hearts" id="hearts"></div>
            <div class="promise" id="promise">æˆ‘çš„é’æ˜¥ä¸€å®šä¼šä»¥å¨¶ä½ ä¸ºç»“å°¾ï¼</div>
        </div>

        <!-- åº•éƒ¨è£…é¥° -->
        <div class="bottom-decoration">
            <div class="heart-line"></div>
        </div>

        <button class="back-btn" id="backFromContent">è¿”å›</button>
    </div>
</div>

<script>
    // ============ DOM å…ƒç´  =============
    const questionScreen = document.getElementById('questionScreen');
    const gentleScreen = document.getElementById('gentleScreen');
    const contentScreen = document.getElementById('contentScreen');
    const optionYes = document.getElementById('optionYes');
    const optionNo = document.getElementById('optionNo');
    const backFromGentle = document.getElementById('backFromGentle');
    const backFromContent = document.getElementById('backFromContent');
    const promise = document.getElementById('promise');
    const floatingParticles = document.getElementById('floatingParticles');
    const heartsContainer = document.getElementById('hearts');
    const circleHeartsContainer = document.getElementById('circleHearts');
    const transitionOverlay = document.getElementById('transitionOverlay');
    const transitionText = document.getElementById('transitionText');
    const flowersContainer = document.getElementById('flowersContainer');
    const romanticElements = document.getElementById('romanticElements');
    const book3d = document.getElementById('book3d');
    const flipPrev = document.getElementById('flipPrev');
    const flipNext = document.getElementById('flipNext');
    const transitionHearts = document.getElementById('transitionHearts');

    // æ–‡æœ¬å†…å®¹
    const texts = [
        'æ—¶é—´æˆ–è®¸å¹¶éçœŸå®å­˜åœ¨ï¼Œåœ¨çˆ±å› æ–¯å¦çš„å¹¿ä¹‰ç›¸å¯¹è®ºé‡Œï¼ŒæŠŠæ—¶é—´å’Œä¸‰ç»´ç©ºé—´åˆä¸ºä¸€ä½“ï¼Œç§°ä¸ºæ—¶ç©ºã€‚åœ¨è¿™ä¸ªå››ç»´ç©ºé—´ä¸­ï¼Œè¿‡å»ï¼Œç°åœ¨ï¼Œæœªæ¥ï¼Œå¹¶ä¸æ˜¯ä¸€æ¡é€æ¸å±•å¼€çš„æ—¶é—´çº¿ï¼Œè€Œæ˜¯åŒæ—¶å­˜åœ¨äºå®‡å®™çš„æ—¶ç©ºä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ—¶é—´ä¸æ˜¯æµåŠ¨çš„ï¼Œè€Œæ˜¯é™æ­¢çš„ç»´åº¦ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ„ŸçŸ¥åˆ°æ—¶é—´çš„æµé€å‘¢ï¼Ÿ',
        'æˆ‘ä»¬ä¹‹æ‰€ä»¥ä¼šæ„Ÿåˆ°æ—¶é—´åœ¨æµåŠ¨ï¼Œæ˜¯å› ä¸ºç†µå¢å®šå¾‹ï¼Œç»™äº†æˆ‘ä»¬å¿ƒç†ä¸Šçš„æ—¶é—´ç®­å¤´ã€‚ç†µæ˜¯æ— åºä¸”æ··ä¹±çš„ï¼Œå®è§‚ä¸–ç•Œé‡Œï¼Œç³»ç»Ÿè‡ªå‘ä»æœ‰åºèµ°å‘æ— åºï¼Œè¿™ä¸€è¿‡ç¨‹ä¸å¯é€†ã€‚æ‰€æœ‰çš„ç”Ÿå‘½éƒ½ä¼šèµ°åˆ°æ¯ç­ï¼Œæ’æ˜Ÿä¼šç‡ƒå°½ï¼Œé»‘æ´ä¼šè’¸å‘ï¼Œå¤§è„‘åªæ˜¯è®°å½•å™¨ã€‚è®°å¿†ï¼Œåªèƒ½è®°å½•ä»ä½ç†µåˆ°é«˜ç†µçš„æ–¹å‘ï¼Œå› æ­¤æˆ‘ä»¬åªè®°å¾—è¿‡å»ï¼Œé¢„æµ‹æœªæ¥ï¼Œä¾¿è¯¯ä»¥ä¸ºæ—¶é—´åœ¨æµåŠ¨ã€‚',
        'è€Œæ—¶é—´æµåŠ¨æ„Ÿï¼Œå°±ç­‰äºåœ¨å¤§è„‘ä¸­å†™å…¥äº†è¯»å–ä¿¡æ¯çš„å•å‘è¿‡ç¨‹ï¼Œè€Œå®‡å®™å±‚é¢çš„æ—¶ç©ºï¼Œæ—¶é—´å¹¶ä¸æµåŠ¨ï¼ŒåŠ¨çš„åªæ˜¯æˆ‘ä»¬å¤§è„‘ä¸­çš„è®°å¿†ã€‚',
        'æˆ‘çš„æ„æ€æ˜¯ï¼Œæ—¶é—´æ— è®ºæ˜¯å¦çœŸå®å­˜åœ¨ï¼Œéƒ½æ— æ³•æ”¹å˜æˆ‘ä»¬ç›¸é‡çš„å¿…ç„¶æ€§ã€‚æˆ‘ä»¬ä¸€èµ·çœ‹æ—¥å‡æ—¥è½ï¼Œç»å†å››å­£æ›´æ›¿ï¼Œä¼šä¸€èµ·æ…¢æ…¢è¡°è€ã€‚æˆ‘ä»¬çš„æ¯ä¸€æ¬¡ç›¸æ‹¥ï¼Œæ¯ä¸€ä¸ªé€‰æ‹©ï¼Œéƒ½æ˜¯åœ¨æ—¶ç©ºä¸­æ—¢å®šè½¨é“ä¸Šçš„å¿…ç„¶ã€‚åªè¦ä½ åœ¨ï¼Œæ—¶é—´ä¾¿ä¸æ˜¯å†°å†·æ¨¡ç³Šçš„æ¦‚å¿µï¼Œè€Œæ˜¯çœŸå®å­˜åœ¨ä¸”å…·æœ‰è§¦æ„Ÿçš„ã€‚'
    ];

    let currentPage = 0;
    let pages = [];
    // ç”¨äºè®°å½•æ¯é¡µæ˜¯å¦å·²æ’­æ”¾æ‰“å­—æœºåŠ¨ç”»
    let hasAnimated = [];

    // ================== åˆ›å»º3Dä¹¦æœ¬é¡µé¢ï¼ˆæ”¯æŒæ‰“å­—æœºæ•ˆæœï¼‰ ==================
    function create3DBookPages() {
        book3d.innerHTML = '';
        pages = [];
        hasAnimated = Array(texts.length).fill(false);

        texts.forEach((text, index) => {
            const page = document.createElement('div');
            page.className = 'page-3d';
            page.id = `page${index + 1}`;
            page.style.zIndex = texts.length - index;

            const contentDiv = document.createElement('div');
            contentDiv.className = 'page-content typewriter';

            const paragraph = document.createElement('p');
            // æŠŠå®Œæ•´æ–‡æœ¬ä¿å­˜åœ¨ data-full å±æ€§ä¸­ï¼Œåˆå§‹ä¸å¡«å……æ–‡æœ¬ï¼Œç”± typeWriterEffect é€å­—ç¬¦å†™å…¥
            paragraph.dataset.full = text;
            paragraph.textContent = '';
            paragraph.classList.add('projected-text');

            contentDiv.appendChild(paragraph);
            page.appendChild(contentDiv);

            book3d.appendChild(page);
            pages.push(page);
        });

        // é‡ç½®å½“å‰é¡µç´¢å¼•å¹¶ç¡®ä¿ç¬¬ä¸€é¡µæ˜¾ç¤ºçŠ¶æ€
        currentPage = 0;
        pages.forEach((p, idx) => {
            if (idx > 0) p.classList.remove('flipped');
        });
    }

    // ================== æ”¹è¿›ç‰ˆæ‰“å­—æœºæ•ˆæœå‡½æ•°ï¼ˆæ¯å­—ç¬¦ span + èŠ‚å¥æ§åˆ¶ï¼‰ ==================
    // pageIndex: è¦æ’­æ”¾çš„é¡µç ç´¢å¼•ï¼›immediate: å¦‚æœä¸º true åˆ™ç›´æ¥å®Œæ•´æ˜¾ç¤ºï¼›onComplete: å®Œæˆåçš„å›è°ƒå‡½æ•°
    function typeWriterEffect(pageIndex, immediate = false, onComplete = null) {
        if (!pages[pageIndex]) return;
        if (hasAnimated[pageIndex] && !immediate) return;

        const page = pages[pageIndex];
        const paragraph = page.querySelector('p');

        const originalText = paragraph.dataset.full || paragraph.textContent || '';
        if (!originalText) {
            hasAnimated[pageIndex] = true;
            if (onComplete) onComplete();
            return;
        }

        // ç«‹åˆ»è®©æ®µè½å¯è§ï¼ˆè§£å†³ opacity:0 å¯¼è‡´çœ‹ä¸è§çš„é—®é¢˜ï¼‰
        paragraph.classList.add('show');
        paragraph.style.opacity = '1';
        paragraph.style.transform = 'translateY(0)';

        // å¦‚æœéœ€è¦ç«‹å³æ˜¾ç¤ºï¼ˆè·³è¿‡æ‰“å­—ï¼‰ï¼Œç›´æ¥å¡«å……å¹¶é€€å‡º
        if (immediate) {
            paragraph.innerHTML = '';
            for (let ch of originalText) {
                const sp = document.createElement('span');
                sp.className = 'char show';
                sp.textContent = ch;
                paragraph.appendChild(sp);
            }
            paragraph.style.borderRight = 'none';
            hasAnimated[pageIndex] = true;
            if (onComplete) onComplete();
            return;
        }

        // æ¸…ç©ºå¹¶é€å­—ç¬¦ç”¨ span åŒ…è£¹
        paragraph.innerHTML = '';
        const frag = document.createDocumentFragment();
        for (let ch of originalText) {
            const sp = document.createElement('span');
            sp.className = 'char';
            sp.textContent = ch;
            frag.appendChild(sp);
        }
        paragraph.appendChild(frag);

        // æ·»åŠ å…‰æ ‡é—ªçƒç±»ï¼ˆCSS æ§åˆ¶ï¼‰
        paragraph.classList.add('typewriter-effect');
        paragraph.style.whiteSpace = 'normal';

        // äººæ€§åŒ–é€Ÿåº¦å‚æ•°ï¼ˆå¯è°ƒï¼‰
        const baseDelay = 70;     // åŸºç¡€æ¯å­—ç¬¦å»¶è¿Ÿï¼ˆmsï¼‰ï¼Œæ”¹å°å˜å¿«
        const variance = 60;      // éšæœºæŠ–åŠ¨èŒƒå›´ï¼ˆmsï¼‰
        const punctuationPause = 260; // æ ‡ç‚¹é¢å¤–åœé¡¿ï¼ˆmsï¼‰

        let idx = 0;
        const chars = paragraph.querySelectorAll('.char');

        function nextChar() {
            if (idx >= chars.length) {
                // å®Œæˆ
                paragraph.classList.remove('typewriter-effect');
                paragraph.style.borderRight = 'none';
                hasAnimated[pageIndex] = true;
                if (onComplete) onComplete();
                return;
            }

            const span = chars[idx];
            span.classList.add('show');

            // è®¡ç®—å»¶è¿Ÿï¼šåŸºæœ¬ + éšæœºï¼›æ ‡ç‚¹ç¬¦å·åŠ æ›´é•¿åœé¡¿ï¼›ç©ºæ ¼çŸ­
            const ch = span.textContent;
            let delay = baseDelay + Math.floor(Math.random() * variance);

            // æ ‡ç‚¹ååŠ åœé¡¿ï¼Œè®©èŠ‚å¥æ›´ä¼˜é›…
            if (/[ï¼Œ,\.!\?ï¼›;ï¼š:ã€]/.test(ch)) {
                delay += punctuationPause + Math.floor(Math.random() * 120);
            } else if (ch === ' ') {
                delay = Math.max(20, Math.floor(baseDelay * 0.4));
            }

            idx++;
            setTimeout(nextChar, delay);
        }

        // å¯åŠ¨æ‰“å­—ï¼ˆç¨å¾®å»¶è¿Ÿä¸€ç‚¹æ›´é¡ºçœ¼ï¼‰
        setTimeout(nextChar, 80);
    }

    // ================== ç¿»é¡µé€»è¾‘ï¼ˆä¿ç•™åŸè¡Œä¸ºï¼Œæ–°å¢è§¦å‘æ‰“å­—æœºæ•ˆæœï¼‰ ==================
    function nextPage() {
        if (currentPage < texts.length - 1) {
            pages[currentPage].classList.add('flipped');
            currentPage++;

            // å½“ç¿»åˆ°ä¸‹ä¸€é¡µæ—¶ï¼Œå¦‚æœè¯¥é¡µå°šæœªæ’­æ”¾æ‰“å­—æœºæ•ˆæœï¼Œè§¦å‘ä¹‹
            setTimeout(() => {
                // å¦‚æœæ˜¯æœ€åä¸€é¡µï¼Œæ·»åŠ å®Œæˆå›è°ƒï¼Œåœ¨æ‰“å­—å®Œæˆå0.5ç§’æ˜¾ç¤ºæ‰¿è¯º
                if (currentPage === texts.length - 1) {
                    typeWriterEffect(currentPage, false, () => {
                        // æ‰“å­—å®Œæˆåç­‰å¾…0.5ç§’å†æ˜¾ç¤ºæ‰¿è¯º
                        setTimeout(() => {
                            promise.classList.add('show');
                            createHearts();
                            createCircleHearts();
                            createParticleHeart();
                        }, 500);
                    });
                } else {
                    typeWriterEffect(currentPage);
                }
            }, 350);
        }
    }

    function prevPage() {
        if (currentPage > 0) {
            pages[currentPage].classList.remove('flipped');
            currentPage--;

            if (currentPage < texts.length - 1) {
                promise.classList.remove('show');
            }

            // å¦‚æœä¸Šä¸€é¡µå°šæœªæ’­æ”¾æ‰“å­—æœºæ•ˆæœï¼Œåˆ™è§¦å‘ä¹‹
            setTimeout(() => {
                typeWriterEffect(currentPage);
            }, 200);
        }
    }

    // ================== å…¶ä½™ç‰¹æ•ˆï¼ˆä¿ç•™åŸæ ·ï¼‰ ==================
    function createParticles() {
        const particles = [];
        const particleCount = 40;

        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.classList.add('particle');

            const size = Math.random() * 4 + 2;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;

            particle.style.left = `${Math.random() * 100}%`;
            particle.style.top = `${Math.random() * 100}%`;

            particle.style.animationDuration = `${Math.random() * 12 + 12}s`;
            particle.style.animationDelay = `${Math.random() * 4}s`;
            particle.style.opacity = '0';

            const colors = ['#ff9ecb', '#c8a4ff', '#a5d8ff', '#e6b0ff'];
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];

            floatingParticles.appendChild(particle);
            particles.push(particle);
        }

        return particles;
    }

    function createRomanticElements() {
        const heartCount = 15;
        for (let i = 0; i < heartCount; i++) {
            const heart = document.createElement('div');
            heart.classList.add('floating-heart');
            heart.innerHTML = 'â¤';

            heart.style.setProperty('--random-x', Math.random());
            heart.style.left = `${Math.random() * 100}%`;
            heart.style.animationDelay = `${Math.random() * 15}s`;
            heart.style.fontSize = `${Math.random() * 20 + 16}px`;

            romanticElements.appendChild(heart);
        }

        const sparkleCount = 30;
        for (let i = 0; i < sparkleCount; i++) {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle');

            sparkle.style.left = `${Math.random() * 100}%`;
            sparkle.style.top = `${Math.random() * 100}%`;
            sparkle.style.animationDelay = `${Math.random() * 3}s`;
            sparkle.style.animationDuration = `${Math.random() * 2 + 2}s`;

            romanticElements.appendChild(sparkle);
        }
    }

    function createFlowers() {
        flowersContainer.innerHTML = '';
        const flowers = ['ğŸŒ¸', 'ğŸŒ¹', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ·', 'ğŸ’', 'ğŸ€'];
        const flowerCount = 25;

        for (let i = 0; i < flowerCount; i++) {
            const flower = document.createElement('div');
            flower.classList.add('flower');
            flower.innerHTML = flowers[Math.floor(Math.random() * flowers.length)];

            flower.style.left = `${Math.random() * 100}%`;
            flower.style.fontSize = `${Math.random() * 20 + 25}px`;

            flower.style.animationDuration = `${Math.random() * 4 + 6}s`;
            flower.style.animationDelay = `${Math.random() * 1.5}s`;

            flowersContainer.appendChild(flower);
        }
    }

    function createHearts() {
        heartsContainer.innerHTML = '';
        const heartCount = 15;

        for (let i = 0; i < heartCount; i++) {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = 'â¤';

            heart.style.left = `${Math.random() * 100}%`;
            heart.style.top = `${Math.random() * 100}%`;

            heart.style.animationDuration = `${Math.random() * 4 + 4}s`;
            heart.style.animationDelay = `${Math.random() * 1.5}s`;

            heartsContainer.appendChild(heart);
        }
    }

    function createCircleHearts() {
        circleHeartsContainer.innerHTML = '';
        const heartCount = 12;

        for (let i = 0; i < heartCount; i++) {
            const heart = document.createElement('div');
            heart.classList.add('circle-heart');
            heart.innerHTML = 'â¤';

            heart.style.animationDelay = `${i * 0.3}s`;

            circleHeartsContainer.appendChild(heart);
        }
    }

    function createTransitionHearts() {
        transitionHearts.innerHTML = '';
        const heartCount = 20;

        for (let i = 0; i < heartCount; i++) {
            const heart = document.createElement('div');
            heart.classList.add('transition-heart');
            heart.innerHTML = 'â¤';

            heart.style.left = `${Math.random() * 100}%`;
            heart.style.animationDelay = `${Math.random() * 0.5}s`;
            heart.style.fontSize = `${Math.random() * 20 + 20}px`;

            transitionHearts.appendChild(heart);
        }
    }

    function createHeartExplosion(x, y) {
        const explosion = document.createElement('div');
        explosion.className = 'heart-explosion';
        explosion.style.left = `${x}px`;
        explosion.style.top = `${y}px`;

        const particleCount = 16;
        for (let i = 0; i < particleCount; i++) {
            const angle = (i / particleCount) * Math.PI * 2;
            const heart = document.createElement('div');
            heart.className = 'heart-particle';
            heart.innerHTML = 'â¤';
            heart.style.setProperty('--tx', Math.cos(angle));
            heart.style.setProperty('--ty', Math.sin(angle));
            heart.style.animationDelay = `${i * 0.05}s`;
            explosion.appendChild(heart);
        }

        document.body.appendChild(explosion);

        setTimeout(() => {
            if (explosion.parentNode) {
                document.body.removeChild(explosion);
            }
        }, 1500);
    }

    function createPetals() {
        const petals = ['ğŸŒ¸', 'ğŸŒ¹', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ·'];
        const petalCount = 15;

        for (let i = 0; i < petalCount; i++) {
            const petal = document.createElement('div');
            petal.className = 'petal';
            petal.innerHTML = petals[Math.floor(Math.random() * petals.length)];

            petal.style.left = `${Math.random() * 100}%`;
            petal.style.color = ['#ff9ecb', '#e6b0ff', '#c8a4ff', '#a5d8ff'][Math.floor(Math.random() * 4)];
            petal.style.fontSize = `${Math.random() * 20 + 20}px`;
            petal.style.animationDuration = `${Math.random() * 6 + 8}s`;
            petal.style.animationDelay = `${Math.random() * 2}s`;

            document.body.appendChild(petal);

            setTimeout(() => {
                if (petal.parentNode) {
                    document.body.removeChild(petal);
                }
            }, 13000);
        }
    }

    function createClickEffect(x, y) {
        const effects = ['â¤', 'âœ¨', 'ğŸŒ¹', 'ğŸŒ¸', 'ğŸ’–', 'ğŸ’•'];
        const effectText = effects[Math.floor(Math.random() * effects.length)];

        const clickEffect = document.createElement('div');
        clickEffect.className = 'click-effect';
        clickEffect.innerHTML = effectText;
        clickEffect.style.left = `${x}px`;
        clickEffect.style.top = `${y}px`;
        clickEffect.style.color = ['#ff9ecb', '#e6b0ff', '#c8a4ff', '#a5d8ff'][Math.floor(Math.random() * 4)];
        clickEffect.style.fontSize = `${Math.random() * 20 + 40}px`;

        document.body.appendChild(clickEffect);

        setTimeout(() => {
            if (clickEffect.parentNode) {
                document.body.removeChild(clickEffect);
            }
        }, 1500);
    }

    function createParticleHeart() {
        const heartContainer = document.createElement('div');
        heartContainer.className = 'particle-text-container';

        const heartPoints = [];
        for (let t = 0; t < Math.PI * 2; t += 0.1) {
            const x = 16 * Math.pow(Math.sin(t), 3);
            const y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
            heartPoints.push({x, y});
        }

        heartPoints.forEach(point => {
            const particle = document.createElement('div');
            particle.className = 'text-particle';
            particle.style.setProperty('--tx', point.x * 10);
            particle.style.setProperty('--ty', point.y * 10);
            particle.style.animationDelay = `${Math.random() * 0.5}s`;
            particle.style.background = ['#ff9ecb', '#e6b0ff', '#c8a4ff'][Math.floor(Math.random() * 3)];
            heartContainer.appendChild(particle);
        });

        document.body.appendChild(heartContainer);

        setTimeout(() => {
            if (heartContainer.parentNode) {
                document.body.removeChild(heartContainer);
            }
        }, 2500);
    }

    // ================== è½¬åœºæ•ˆæœ ==================
    function showTransition(callback) {
        createTransitionHearts();
        createPetals();

        transitionOverlay.classList.add('active');
        setTimeout(() => {
            transitionText.classList.add('show');
        }, 80);

        setTimeout(() => {
            transitionText.classList.remove('show');
        }, 2000);

        setTimeout(() => {
            transitionOverlay.classList.remove('active');
            if (callback) callback();
        }, 2500);
    }

    // ================== é¡µé¢åˆ‡æ¢å‡½æ•° ==================
    function showGentleScreen() {
        createFlowers();
        createHeartExplosion(window.innerWidth / 2, window.innerHeight / 2);

        questionScreen.style.opacity = '0';
        questionScreen.style.pointerEvents = 'none';

        setTimeout(() => {
            gentleScreen.classList.add('active');
        }, 400);
    }

    function showContentScreen() {
        showTransition(() => {
            questionScreen.style.opacity = '0';
            questionScreen.style.pointerEvents = 'none';

            contentScreen.classList.add('active');

            // åˆ›å»º3Dä¹¦æœ¬é¡µé¢ï¼ˆå·²æ˜¯æ”¯æŒæ‰“å­—æœºæ•ˆæœçš„ç‰ˆæœ¬ï¼‰
            create3DBookPages();

            // æ˜¾ç¤ºç¬¬ä¸€é¡µçš„æ–‡å­—ï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
            setTimeout(() => {
                typeWriterEffect(0);
            }, 500);
        });
    }

    function backToQuestion() {
        gentleScreen.classList.remove('active');
        contentScreen.classList.remove('active');

        // é‡ç½®å†…å®¹é¡µé¢çš„åŠ¨ç”»çŠ¶æ€
        promise.classList.remove('show');
        heartsContainer.innerHTML = '';
        circleHeartsContainer.innerHTML = '';

        // é‡ç½® hasAnimatedï¼Œç§»é™¤ç¿»é¡µæ•ˆæœ
        hasAnimated = Array(texts.length).fill(false);
        pages.forEach((page, index) => {
            if (index > 0) {
                page.classList.remove('flipped');
            }
        });
        currentPage = 0;

        setTimeout(() => {
            questionScreen.style.opacity = '1';
            questionScreen.style.pointerEvents = 'all';
        }, 400);
    }

    // ================== æŒ‰é’®åŠ¨ç”»å’Œäº‹ä»¶ç»‘å®š ==================
    function animateButtons() {
        const buttons = document.querySelectorAll('.option-btn');
        buttons.forEach((btn, index) => {
            btn.style.animation = `fadeInUp 0.8s ${index * 0.2 + 0.8}s forwards`;
        });
    }

    optionYes.addEventListener('click', showGentleScreen);
    optionNo.addEventListener('click', showContentScreen);
    backFromGentle.addEventListener('click', backToQuestion);
    backFromContent.addEventListener('click', backToQuestion);
    flipPrev.addEventListener('click', prevPage);
    flipNext.addEventListener('click', nextPage);

    document.addEventListener('click', function(e) {
        createClickEffect(e.clientX, e.clientY);
    });

    // ================== åˆå§‹åŒ– ==================
    window.onload = function() {
        createParticles();
        createRomanticElements();
        animateButtons();

        // é”®ç›˜ç¿»é¡µæ”¯æŒ
        document.addEventListener('keydown', (e) => {
            if (contentScreen.classList.contains('active')) {
                if (e.key === 'ArrowRight') {
                    nextPage();
                } else if (e.key === 'ArrowLeft') {
                    prevPage();
                }
            }
        });

        // è§¦æ‘¸æ»‘åŠ¨æ”¯æŒ
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);

        function handleSwipe() {
            if (contentScreen.classList.contains('active')) {
                if (touchEndX < touchStartX - 50) {
                    nextPage();
                } else if (touchEndX > touchStartX + 50) {
                    prevPage();
                }
            }
        }
    };
</script>
</body>
</html>